<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>회원가입</title>
</head>
<body>

  <h2>회원가입</h2>
  <form id="signupForm">
    <label>아이디: <input type="text" id="signupUsername" required></label><br><br>
    <label>비밀번호: <input type="password" id="signupPassword" required></label><br><br>
    <label>비밀번호 확인: <input type="password1" id="signupPassword1" required></label><br><br>
    <button type="submit">가입하기</button>
  </form>

  <p><a href="/">로그인으로 돌아가기</a></p>
  <script>
    // SHA-256 해싱 함수
    async function hashValue(value) {
      const encoder = new TextEncoder();
      const data = encoder.encode(value);
      const hashBuffer = await crypto.subtle.digest('SHA-256', data);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    }
  
    document.getElementById("signupForm").addEventListener("submit", async function (e) {
      e.preventDefault();
  
      const username = document.getElementById("signupUsername").value;
      const password = document.getElementById("signupPassword").value;
      const confirmPassword = document.getElementById("signupPassword1").value;
  
      if (password !== confirmPassword) {
        alert("비밀번호가 일치하지 않습니다.");
        return;
      }
  
      // username과 password 해싱
      const hashedUsername = await hashValue(username);
      const hashedPassword = await hashValue(password);
  
      // 로컬스토리지에 저장 (key: "user_<해시된ID>")
      const userData = {
        username: hashedUsername,
        password: hashedPassword
      };
      localStorage.setItem("user_" + hashedUsername, JSON.stringify(userData));
  
      alert("회원가입이 완료되었습니다.");
      document.getElementById("signupForm").reset();
    });
  </script>

</body>
</html>
